"use strict";function asyncGeneratorStep(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function _asyncToGenerator(c){return function(){var t=this,i=arguments;return new Promise(function(e,r){var n=c.apply(t,i);function o(t){asyncGeneratorStep(n,e,r,o,a,"next",t)}function a(t){asyncGeneratorStep(n,e,r,o,a,"throw",t)}o(void 0)})}}var pause;document.querySelector("#clickMe").addEventListener("click",openPopup),document.querySelector("#clickMe1").addEventListener("click",openPopup),document.querySelector("#closePopup").addEventListener("click",closePopup);var el=$("#popup"),inner=$(".popup-inner");function openPopup(){inner.attr("style","margin-right:20px"),el.removeClass("fade-out").addClass("fade-in"),el.attr("style","visibility:visible"),$("body").css({overflow:"hidden"}),chatbot()}function closePopup(){inner.attr("style","margin-right:0px"),el.removeClass("fade-in").addClass("fade-out"),el.attr("style","visibility:hidden"),$("body").css({overflow:"auto"})}var privacyLink="http://integrityfinancialservicellc.com/wp-content/uploads/2015/05/IFS-Privacy-Pledge-and-Notification.pdf",fields={name:"",email:"",phone:"",portfolioSize:""},chatbot=function(){var e=!1;return _asyncToGenerator(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=26;break}return e=!0,t.next=4,writeText({text:"Our book has been requested over NaN times!",style:"text",writer:"bot"});case 4:return t.next=6,writeText({text:"All we need some information to determine whether this book suits your needs.",style:"text",writer:"bot"});case 6:return t.next=8,writeText({text:"First let's make sure you're not a robot.  Click on this bubble.",style:"button",writer:"bot"});case 8:return t.next=10,writeText({text:"I'm not a robot!",style:"text",writer:"user"});case 10:return t.next=12,writeText({text:"Perfect! What's your name?",style:"form",field:"name",writer:"bot"});case 12:return fields.name=t.sent,t.next=15,writeText({text:fields.name,style:"text",writer:"user"});case 15:return t.next=17,writeText({text:"Great! Nice to meet you ".concat(fields.name,"!"),style:"text",writer:"bot"});case 17:return t.next=19,writeText({text:"Before we go any further, we want you to know we take your data VERY seriously.",style:"text",writer:"bot"});case 19:return t.next=21,writeText({text:"<a href=".concat(privacyLink,' target="_blank">Here</a> is our privacy policy.'),style:"text",writer:"bot"});case 21:return t.next=23,writeText({text:"What's a good phone number to reach you at? (We won't spam you; only a one time confirmation)",style:"form",field:"phone",writer:"bot"});case 23:return fields.phone=t.sent,t.next=26,writeText({text:fields.phone,style:"text",writer:"user"});case 26:case"end":return t.stop()}},t)}))}();function writeText(t){return _writeText.apply(this,arguments)}function _writeText(){return(_writeText=_asyncToGenerator(regeneratorRuntime.mark(function t(e){var r,n,o,a,i,c,s,u,l,d,p;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:$(".row-current").removeClass("row-current"),$("#bot-chat-current").removeAttr("id"),$("#user-chat-current").removeAttr("id"),$("#left-tag-current").removeAttr("id"),$("#right-tag-current").removeAttr("id"),$("#popup-window").append('<div class="row align-items-center chat-row row-current"> \t\t\t\t\t\t<div class="col-md-1 col-xl-2 padding-column"> \t\t\t\t\t\t</div> \t\t\t\t\t\t<div id="left-tag-current" class="col-2 col-sm-1 logo-column"> \t\t\t\t\t\t</div> \t\t\t\t\t\t<div class="col-8 col-sm-10 col-md-8 col-xl-6 content-column"> \t\t\t\t\t\t\t<div id="bot-chat-current" class="chat-bubble bot chat-fade-in"> \t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t<div id="user-chat-current" class="chat-bubble user float-right chat-fade-in"> \t\t\t\t\t\t\t</div> \t\t\t\t\t\t</div> \t\t\t\t\t\t<div id="right-tag-current" class="col-2 col-sm-1 logo-column"> \t\t\t\t\t\t</div> \t\t\t\t\t\t<div class="col-md-1 col-xl-2 padding-column"> \t\t\t\t\t\t</div> \t\t\t\t\t</div>'),"bot"===e.writer?(r=1<$(".chat-row").length?'<img id="bot-logo-current" src="images/IFSLogo.png" class="bot-logo logo-pop-in">':'<img id="bot-logo-current" src="images/IFSLogo.png" class="bot-logo">',$("#right-tag-current").append('<div id="bot-clock-current" class="bot-clock"></div>')):$("#left-tag-current").append('<div id="user-clock-current" class="user-clock"></div>'),s=new Date,s=s.getHours()+":"+s.getMinutes()+":"+s.getSeconds(),"bot"===e.writer?(n=$("#bot-chat-current"),o=$("#bot-clock-current"),i=$("#user-chat-current"),a=$("#user-clock-current"),c='<div class="clock-text bot-clock-text">'+s+"</div>",$(".bot.last").removeClass("last")):(n=$("#user-chat-current"),o=$("#user-clock-current"),i=$("#bot-chat-current"),a=$("#bot-clock-current"),$(".row-current").addClass("height-shift"),c='<div class="clock-text user-clock-text" style="height:100%;max-height:100%">'+s+"</div>",$(".user.last").removeClass("last")),n.addClass("last"),a.remove(),i.remove(),o.append(c),o.removeAttr("id"),t.t0=e.style,t.next="text"===t.t0?19:"form"===t.t0?22:"button"===t.t0?28:39;break;case 19:return n.append('<p class="chat-text">'+e.text+"</p>"),u=delay(1e3),t.abrupt("break",39);case 22:return n.append('<p class="chat-text">'+e.text+'</p><div class="input-group mb-3"> \t\t\t<input type="text" id="'.concat(e.field,'-input" class="form-control" placeholder="Your ').concat(e.field,'" aria-label="Your ').concat(e.field,'" aria-describedby="').concat(e.field,'-submit">  \n  \t\t\t<div class="input-group-append"> \t\t\t<span class="input-group-text" id="').concat(e.field,'-submit"> ok</span></div></div>')),l=$("#".concat(e.field,"-submit")),pause=!0,l.on("click",unpause),u=pauseUntil("#".concat(e.field,"-input")),t.abrupt("break",39);case 28:return(l=document.createElement("a")).style.color="black",n[0].parentNode.replaceChild(l,n[0]),l.appendChild(n[0]),l.classList.add("chat-button"),n.append('<p class="chat-text">'+e.text+"</p>"),pause=!0,n.on("click",unpause),u=pauseUntil(),t.abrupt("break",39);case 39:return"bot"===e.writer&&(1<$(".content-column").length&&(d=$(".row-current").height()/2+$("#last-bot-row").height()/2,0!==(p=$(".height-shift")).length&&p.each(function(){d+=$(this).height()}),$("#bot-logo-current").velocity({top:d},{duration:400,easing:"easeInQuad",complete:function(t){setTimeout(function(){$(t).css("visibility","hidden").removeAttr("id"),p.removeClass("height-shift")},300)}}),$("#last-bot-row").removeAttr("id"),$("#bot-logo-current").removeAttr("id"),$("bot-logo").last().attr("id","bot-logo-current")),$("#left-tag-current").append(r),$(".row-current").attr("id","last-bot-row")),t.next=42,u;case 42:return t.abrupt("return",t.sent);case 43:case"end":return t.stop()}},t)}))).apply(this,arguments)}function delay(r){return new Promise(function(t,e){setTimeout(function(){t(null)},r)})}function unpause(){pause=!1}function pauseUntil(t){return _pauseUntil.apply(this,arguments)}function _pauseUntil(){return(_pauseUntil=_asyncToGenerator(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(pause)return t.next=3,delay(100);t.next=5;break;case 3:t.next=0;break;case 5:return t.abrupt("return",$(e).val());case 6:case"end":return t.stop()}},t)}))).apply(this,arguments)}function encryptFormData(t){}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdHMuanMiXSwibmFtZXMiOlsicGF1c2UiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJhZGRFdmVudExpc3RlbmVyIiwib3BlblBvcHVwIiwiY2xvc2VQb3B1cCIsIiQiLCJlbCIsImF0dHIiLCJpbm5lciIsImFkZENsYXNzIiwib3ZlcmZsb3ciLCJyZW1vdmVDbGFzcyIsImNoYXRib3QiLCJjc3MiLCJwcml2YWN5TGluayIsImZpZWxkcyIsIm5hbWUiLCJlbWFpbCIsInBob25lIiwicG9ydGZvbGlvU2l6ZSIsImV4ZWN1dGVkIiwiX2NhbGxlZSIsInJlZ2VuZXJhdG9yUnVudGltZSIsIndyYXAiLCJfY29udGV4dCIsInByZXYiLCJuZXh0Iiwid3JpdGVUZXh0IiwidGV4dCIsInN0eWxlIiwid3JpdGVyIiwic2VudCIsImNvbmNhdCIsImZpZWxkIiwic3RvcCIsIl9jYWxsZWUyIiwibG9nb1RleHQiLCJjaGF0IiwiY2xvY2siLCJjbG9ja1RvUmVtb3ZlIiwiY2hhdFRvUmVtb3ZlIiwiY2xvY2tUZXh0IiwidGltZSIsInJldHVyblZhbHVlIiwid3JhcHBlciIsImxvZ29TaGlmdERvd24iLCJyb3dzVG9TaGlmdCIsIl9jb250ZXh0MiIsInJlbW92ZUF0dHIiLCJhcHBlbmQiLCJsZW5ndGgiLCJkIiwiRGF0ZSIsImdldEhvdXJzIiwiZ2V0TWludXRlcyIsImdldFNlY29uZHMiLCJvcHRpb25zIiwiYnViYmxlSFRNTCIsInJlbW92ZSIsInQwIiwiZGVsYXkiLCJhYnJ1cHQiLCJnbyIsIm9uIiwidW5wYXVzZSIsInBhdXNlVW50aWwiLCJjcmVhdGVFbGVtZW50IiwicGFyZW50Tm9kZSIsInJlcGxhY2VDaGlsZCIsImhlaWdodCIsInRoaXMiLCJ2ZWxvY2l0eSIsInRvcCIsImVhc2luZyIsImNvbXBsZXRlIiwiZWxlbWVudCIsInNldFRpbWVvdXQiLCJwYXJlbnQiLCJhZGQiLCJtcyIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiX2NhbGxl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QUFBMEQsRUFBQXZCLE9BQUEsU0FFR3hELEVBQUFzRSxHQUdBVSxPQUxILEtBQUEsRUFBQSxJQUFBLE1BQUEsT0FBQUQsRUFBQWxELFNBQUFpRCxPLHNCQVFPVCxTQUFBQSxnQkFBQUEiLCJmaWxlIjoic2NyaXB0cy5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xyXG5cclxudmFyIHBhdXNlO1xyXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NsaWNrTWVcIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9wZW5Qb3B1cCk7XHJcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2xpY2tNZTFcIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9wZW5Qb3B1cCk7XHJcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2xvc2VQb3B1cFwiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgY2xvc2VQb3B1cCk7XHJcbmxldCBlbCA9ICQoXCIjcG9wdXBcIik7XHJcbmxldCBpbm5lciA9ICQoXCIucG9wdXAtaW5uZXJcIik7XHJcblxyXG5mdW5jdGlvbiBvcGVuUG9wdXAoKSB7XHJcbiAgICBpbm5lci5hdHRyKFwic3R5bGVcIiwgXCJtYXJnaW4tcmlnaHQ6MjBweFwiKTtcclxuICAgIGVsLnJlbW92ZUNsYXNzKFwiZmFkZS1vdXRcIikuYWRkQ2xhc3MoXCJmYWRlLWluXCIpO1xyXG4gICAgZWwuYXR0cihcInN0eWxlXCIsIFwidmlzaWJpbGl0eTp2aXNpYmxlXCIpO1xyXG4gICAgJChcImJvZHlcIikuY3NzKHsgb3ZlcmZsb3c6IFwiaGlkZGVuXCIgfSk7XHJcbiAgICBjaGF0Ym90KCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNsb3NlUG9wdXAoKSB7XHJcbiAgICBpbm5lci5hdHRyKFwic3R5bGVcIiwgXCJtYXJnaW4tcmlnaHQ6MHB4XCIpO1xyXG4gICAgZWwucmVtb3ZlQ2xhc3MoXCJmYWRlLWluXCIpLmFkZENsYXNzKFwiZmFkZS1vdXRcIik7XHJcbiAgICBlbC5hdHRyKFwic3R5bGVcIiwgXCJ2aXNpYmlsaXR5OmhpZGRlblwiKTtcclxuICAgIC8vIGlmICgkKHdpbmRvdykud2lkdGgoKSA+PSA3NjgpIHtcclxuICAgICAgICAkKFwiYm9keVwiKS5jc3MoeyBvdmVyZmxvdzogXCJhdXRvXCIgfSk7XHJcbiAgICAvLyB9XHJcbn1cclxuXHJcbi8qR2V0IGV4aXN0aW5nIHJvdyBoZWlnaHQsIGFkZCAxcmVtIGZvciBldmVyeSB0aW1lIGNoYXQtYnViYmxlIHRleHQgd2lsbCB3cmFwLCBhbmltYXRlIGJvdC1sb2dvJ3Mgc2hpZnQgZG93biB3aXRoIHRvcDpcclxuICBtb3ZlIGJvdC1sb2dvIHRvIG5ldyByb3cgYWZ0ZXIgYW5pbWF0aW9uIHRpbWVvdXQqL1xyXG5sZXQgcHJpdmFjeUxpbmsgPVxyXG4gICAgXCJodHRwOi8vaW50ZWdyaXR5ZmluYW5jaWFsc2VydmljZWxsYy5jb20vd3AtY29udGVudC91cGxvYWRzLzIwMTUvMDUvSUZTLVByaXZhY3ktUGxlZGdlLWFuZC1Ob3RpZmljYXRpb24ucGRmXCI7XHJcbmxldCBmaWVsZHMgPSB7XHJcbiAgICBuYW1lOiBcIlwiLFxyXG4gICAgZW1haWw6IFwiXCIsXHJcbiAgICBwaG9uZTogXCJcIixcclxuICAgIHBvcnRmb2xpb1NpemU6IFwiXCIsXHJcbn07XHJcblxyXG5sZXQgY2hhdGJvdCA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICBsZXQgZXhlY3V0ZWQgPSBmYWxzZTtcclxuICAgIHJldHVybiBhc3luYyBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKCFleGVjdXRlZCkge1xyXG4gICAgICAgICAgICBleGVjdXRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIGF3YWl0IHdyaXRlVGV4dCh7XHJcbiAgICAgICAgICAgICAgICB0ZXh0OiBcIk91ciBib29rIGhhcyBiZWVuIHJlcXVlc3RlZCBvdmVyIE5hTiB0aW1lcyFcIixcclxuICAgICAgICAgICAgICAgIHN0eWxlOiBcInRleHRcIixcclxuICAgICAgICAgICAgICAgIHdyaXRlcjogXCJib3RcIixcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGF3YWl0IHdyaXRlVGV4dCh7XHJcbiAgICAgICAgICAgICAgICB0ZXh0OlxyXG4gICAgICAgICAgICAgICAgICAgIFwiQWxsIHdlIG5lZWQgc29tZSBpbmZvcm1hdGlvbiB0byBkZXRlcm1pbmUgd2hldGhlciB0aGlzIGJvb2sgc3VpdHMgeW91ciBuZWVkcy5cIixcclxuICAgICAgICAgICAgICAgIHN0eWxlOiBcInRleHRcIixcclxuICAgICAgICAgICAgICAgIHdyaXRlcjogXCJib3RcIixcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGF3YWl0IHdyaXRlVGV4dCh7XHJcbiAgICAgICAgICAgICAgICB0ZXh0OlxyXG4gICAgICAgICAgICAgICAgICAgIFwiRmlyc3QgbGV0J3MgbWFrZSBzdXJlIHlvdSdyZSBub3QgYSByb2JvdC4gIENsaWNrIG9uIHRoaXMgYnViYmxlLlwiLFxyXG4gICAgICAgICAgICAgICAgc3R5bGU6IFwiYnV0dG9uXCIsXHJcbiAgICAgICAgICAgICAgICB3cml0ZXI6IFwiYm90XCIsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBhd2FpdCB3cml0ZVRleHQoe1xyXG4gICAgICAgICAgICAgICAgdGV4dDogXCJJJ20gbm90IGEgcm9ib3QhXCIsXHJcbiAgICAgICAgICAgICAgICBzdHlsZTogXCJ0ZXh0XCIsXHJcbiAgICAgICAgICAgICAgICB3cml0ZXI6IFwidXNlclwiLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgZmllbGRzLm5hbWUgPSBhd2FpdCB3cml0ZVRleHQoe1xyXG4gICAgICAgICAgICAgICAgdGV4dDogXCJQZXJmZWN0ISBXaGF0J3MgeW91ciBuYW1lP1wiLFxyXG4gICAgICAgICAgICAgICAgc3R5bGU6IFwiZm9ybVwiLFxyXG4gICAgICAgICAgICAgICAgZmllbGQ6IFwibmFtZVwiLFxyXG4gICAgICAgICAgICAgICAgd3JpdGVyOiBcImJvdFwiLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgYXdhaXQgd3JpdGVUZXh0KHtcclxuICAgICAgICAgICAgICAgIHRleHQ6IGZpZWxkcy5uYW1lLFxyXG4gICAgICAgICAgICAgICAgc3R5bGU6IFwidGV4dFwiLFxyXG4gICAgICAgICAgICAgICAgd3JpdGVyOiBcInVzZXJcIixcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGF3YWl0IHdyaXRlVGV4dCh7XHJcbiAgICAgICAgICAgICAgICB0ZXh0OiBgR3JlYXQhIE5pY2UgdG8gbWVldCB5b3UgJHtmaWVsZHMubmFtZX0hYCxcclxuICAgICAgICAgICAgICAgIHN0eWxlOiBcInRleHRcIixcclxuICAgICAgICAgICAgICAgIHdyaXRlcjogXCJib3RcIixcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGF3YWl0IHdyaXRlVGV4dCh7XHJcbiAgICAgICAgICAgICAgICB0ZXh0OlxyXG4gICAgICAgICAgICAgICAgICAgIFwiQmVmb3JlIHdlIGdvIGFueSBmdXJ0aGVyLCB3ZSB3YW50IHlvdSB0byBrbm93IHdlIHRha2UgeW91ciBkYXRhIFZFUlkgc2VyaW91c2x5LlwiLFxyXG4gICAgICAgICAgICAgICAgc3R5bGU6IFwidGV4dFwiLFxyXG4gICAgICAgICAgICAgICAgd3JpdGVyOiBcImJvdFwiLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgYXdhaXQgd3JpdGVUZXh0KHtcclxuICAgICAgICAgICAgICAgIHRleHQ6IGA8YSBocmVmPSR7cHJpdmFjeUxpbmt9IHRhcmdldD1cIl9ibGFua1wiPkhlcmU8L2E+IGlzIG91ciBwcml2YWN5IHBvbGljeS5gLFxyXG4gICAgICAgICAgICAgICAgc3R5bGU6IFwidGV4dFwiLFxyXG4gICAgICAgICAgICAgICAgd3JpdGVyOiBcImJvdFwiLFxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGZpZWxkcy5waG9uZSA9IGF3YWl0IHdyaXRlVGV4dCh7XHJcbiAgICAgICAgICAgICAgICB0ZXh0OlxyXG4gICAgICAgICAgICAgICAgICAgIFwiV2hhdCdzIGEgZ29vZCBwaG9uZSBudW1iZXIgdG8gcmVhY2ggeW91IGF0PyAoV2Ugd29uJ3Qgc3BhbSB5b3U7IG9ubHkgYSBvbmUgdGltZSBjb25maXJtYXRpb24pXCIsXHJcbiAgICAgICAgICAgICAgICBzdHlsZTogXCJmb3JtXCIsXHJcbiAgICAgICAgICAgICAgICBmaWVsZDogXCJwaG9uZVwiLFxyXG4gICAgICAgICAgICAgICAgd3JpdGVyOiBcImJvdFwiLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgYXdhaXQgd3JpdGVUZXh0KHtcclxuICAgICAgICAgICAgICAgIHRleHQ6IGZpZWxkcy5waG9uZSxcclxuICAgICAgICAgICAgICAgIHN0eWxlOiBcInRleHRcIixcclxuICAgICAgICAgICAgICAgIHdyaXRlcjogXCJ1c2VyXCIsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn0pKCk7XHJcblxyXG5hc3luYyBmdW5jdGlvbiB3cml0ZVRleHQob3B0aW9ucykge1xyXG4gICAgY29uc3QgYnViYmxlSFRNTCA9XHJcbiAgICAgICAgJzxkaXYgY2xhc3M9XCJyb3cgYWxpZ24taXRlbXMtY2VudGVyIGNoYXQtcm93IHJvdy1jdXJyZW50XCI+IFxcXHJcblx0XHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJjb2wtbWQtMSBjb2wteGwtMiBwYWRkaW5nLWNvbHVtblwiPiBcXFxyXG5cdFx0XHRcdFx0XHQ8L2Rpdj4gXFxcclxuXHRcdFx0XHRcdFx0PGRpdiBpZD1cImxlZnQtdGFnLWN1cnJlbnRcIiBjbGFzcz1cImNvbC0yIGNvbC1zbS0xIGxvZ28tY29sdW1uXCI+IFxcXHJcblx0XHRcdFx0XHRcdDwvZGl2PiBcXFxyXG5cdFx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwiY29sLTggY29sLXNtLTEwIGNvbC1tZC04IGNvbC14bC02IGNvbnRlbnQtY29sdW1uXCI+IFxcXHJcblx0XHRcdFx0XHRcdFx0PGRpdiBpZD1cImJvdC1jaGF0LWN1cnJlbnRcIiBjbGFzcz1cImNoYXQtYnViYmxlIGJvdCBjaGF0LWZhZGUtaW5cIj4gXFxcclxuXHRcdFx0XHRcdFx0XHQ8L2Rpdj4gXFxcclxuXHRcdFx0XHRcdFx0XHQ8ZGl2IGlkPVwidXNlci1jaGF0LWN1cnJlbnRcIiBjbGFzcz1cImNoYXQtYnViYmxlIHVzZXIgZmxvYXQtcmlnaHQgY2hhdC1mYWRlLWluXCI+IFxcXHJcblx0XHRcdFx0XHRcdFx0PC9kaXY+IFxcXHJcblx0XHRcdFx0XHRcdDwvZGl2PiBcXFxyXG5cdFx0XHRcdFx0XHQ8ZGl2IGlkPVwicmlnaHQtdGFnLWN1cnJlbnRcIiBjbGFzcz1cImNvbC0yIGNvbC1zbS0xIGxvZ28tY29sdW1uXCI+IFxcXHJcblx0XHRcdFx0XHRcdDwvZGl2PiBcXFxyXG5cdFx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwiY29sLW1kLTEgY29sLXhsLTIgcGFkZGluZy1jb2x1bW5cIj4gXFxcclxuXHRcdFx0XHRcdFx0PC9kaXY+IFxcXHJcblx0XHRcdFx0XHQ8L2Rpdj4nO1xyXG5cclxuICAgICQoXCIucm93LWN1cnJlbnRcIikucmVtb3ZlQ2xhc3MoXCJyb3ctY3VycmVudFwiKTtcclxuICAgICQoXCIjYm90LWNoYXQtY3VycmVudFwiKS5yZW1vdmVBdHRyKFwiaWRcIik7XHJcbiAgICAkKFwiI3VzZXItY2hhdC1jdXJyZW50XCIpLnJlbW92ZUF0dHIoXCJpZFwiKTtcclxuICAgICQoXCIjbGVmdC10YWctY3VycmVudFwiKS5yZW1vdmVBdHRyKFwiaWRcIik7XHJcbiAgICAkKFwiI3JpZ2h0LXRhZy1jdXJyZW50XCIpLnJlbW92ZUF0dHIoXCJpZFwiKTtcclxuXHJcbiAgICBsZXQgbG9nb1RleHQ7XHJcbiAgICAkKFwiI3BvcHVwLXdpbmRvd1wiKS5hcHBlbmQoYnViYmxlSFRNTCk7XHJcbiAgICBpZiAob3B0aW9ucy53cml0ZXIgPT09IFwiYm90XCIpIHtcclxuICAgICAgICBpZiAoJChcIi5jaGF0LXJvd1wiKS5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgICAgIGxvZ29UZXh0ID1cclxuICAgICAgICAgICAgICAgICc8aW1nIGlkPVwiYm90LWxvZ28tY3VycmVudFwiIHNyYz1cImltYWdlcy9JRlNMb2dvLnBuZ1wiIGNsYXNzPVwiYm90LWxvZ28gbG9nby1wb3AtaW5cIj4nO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGxvZ29UZXh0ID1cclxuICAgICAgICAgICAgICAgICc8aW1nIGlkPVwiYm90LWxvZ28tY3VycmVudFwiIHNyYz1cImltYWdlcy9JRlNMb2dvLnBuZ1wiIGNsYXNzPVwiYm90LWxvZ29cIj4nO1xyXG4gICAgICAgIH1cclxuICAgICAgICAkKFwiI3JpZ2h0LXRhZy1jdXJyZW50XCIpLmFwcGVuZChcclxuICAgICAgICAgICAgJzxkaXYgaWQ9XCJib3QtY2xvY2stY3VycmVudFwiIGNsYXNzPVwiYm90LWNsb2NrXCI+PC9kaXY+J1xyXG4gICAgICAgICk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgICQoXCIjbGVmdC10YWctY3VycmVudFwiKS5hcHBlbmQoXHJcbiAgICAgICAgICAgICc8ZGl2IGlkPVwidXNlci1jbG9jay1jdXJyZW50XCIgY2xhc3M9XCJ1c2VyLWNsb2NrXCI+PC9kaXY+J1xyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IGNoYXQsIGNsb2NrLCBjbG9ja1RvUmVtb3ZlLCBjaGF0VG9SZW1vdmUsIGNsb2NrVGV4dDtcclxuICAgIGxldCBkID0gbmV3IERhdGUoKTtcclxuICAgIGxldCB0aW1lID0gZC5nZXRIb3VycygpICsgXCI6XCIgKyBkLmdldE1pbnV0ZXMoKSArIFwiOlwiICsgZC5nZXRTZWNvbmRzKCk7XHJcblxyXG4gICAgaWYgKG9wdGlvbnMud3JpdGVyID09PSBcImJvdFwiKSB7XHJcbiAgICAgICAgY2hhdCA9ICQoXCIjYm90LWNoYXQtY3VycmVudFwiKTtcclxuICAgICAgICBjbG9jayA9ICQoXCIjYm90LWNsb2NrLWN1cnJlbnRcIik7XHJcbiAgICAgICAgY2hhdFRvUmVtb3ZlID0gJChcIiN1c2VyLWNoYXQtY3VycmVudFwiKTtcclxuICAgICAgICBjbG9ja1RvUmVtb3ZlID0gJChcIiN1c2VyLWNsb2NrLWN1cnJlbnRcIik7XHJcbiAgICAgICAgY2xvY2tUZXh0ID0gJzxkaXYgY2xhc3M9XCJjbG9jay10ZXh0IGJvdC1jbG9jay10ZXh0XCI+JyArIHRpbWUgKyBcIjwvZGl2PlwiO1xyXG4gICAgICAgICQoXCIuYm90Lmxhc3RcIikucmVtb3ZlQ2xhc3MoXCJsYXN0XCIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBjaGF0ID0gJChcIiN1c2VyLWNoYXQtY3VycmVudFwiKTtcclxuICAgICAgICBjbG9jayA9ICQoXCIjdXNlci1jbG9jay1jdXJyZW50XCIpO1xyXG4gICAgICAgIGNoYXRUb1JlbW92ZSA9ICQoXCIjYm90LWNoYXQtY3VycmVudFwiKTtcclxuICAgICAgICBjbG9ja1RvUmVtb3ZlID0gJChcIiNib3QtY2xvY2stY3VycmVudFwiKTtcclxuICAgICAgICAkKFwiLnJvdy1jdXJyZW50XCIpLmFkZENsYXNzKFwiaGVpZ2h0LXNoaWZ0XCIpO1xyXG4gICAgICAgIGNsb2NrVGV4dCA9XHJcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiY2xvY2stdGV4dCB1c2VyLWNsb2NrLXRleHRcIiBzdHlsZT1cImhlaWdodDoxMDAlO21heC1oZWlnaHQ6MTAwJVwiPicgK1xyXG4gICAgICAgICAgICB0aW1lICtcclxuICAgICAgICAgICAgXCI8L2Rpdj5cIjtcclxuICAgICAgICAkKFwiLnVzZXIubGFzdFwiKS5yZW1vdmVDbGFzcyhcImxhc3RcIik7XHJcbiAgICB9XHJcbiAgICBjaGF0LmFkZENsYXNzKFwibGFzdFwiKTtcclxuICAgIGNsb2NrVG9SZW1vdmUucmVtb3ZlKCk7XHJcbiAgICBjaGF0VG9SZW1vdmUucmVtb3ZlKCk7XHJcbiAgICBjbG9jay5hcHBlbmQoY2xvY2tUZXh0KTtcclxuICAgIGNsb2NrLnJlbW92ZUF0dHIoXCJpZFwiKTtcclxuICAgIGxldCByZXR1cm5WYWx1ZTtcclxuXHJcbiAgICBzd2l0Y2ggKG9wdGlvbnMuc3R5bGUpIHtcclxuICAgICAgICBjYXNlIFwidGV4dFwiOlxyXG4gICAgICAgICAgICBjaGF0LmFwcGVuZCgnPHAgY2xhc3M9XCJjaGF0LXRleHRcIj4nICsgb3B0aW9ucy50ZXh0ICsgXCI8L3A+XCIpO1xyXG4gICAgICAgICAgICByZXR1cm5WYWx1ZSA9IGRlbGF5KDEwMDApO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIFwiZm9ybVwiOlxyXG4gICAgICAgICAgICBjaGF0LmFwcGVuZChcclxuICAgICAgICAgICAgICAgICc8cCBjbGFzcz1cImNoYXQtdGV4dFwiPicgK1xyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMudGV4dCArXHJcbiAgICAgICAgICAgICAgICAgICAgYDwvcD48ZGl2IGNsYXNzPVwiaW5wdXQtZ3JvdXAgbWItM1wiPiBcXFxyXG5cdFx0XHQ8aW5wdXQgdHlwZT1cInRleHRcIiBpZD1cIiR7b3B0aW9ucy5maWVsZH0taW5wdXRcIiBjbGFzcz1cImZvcm0tY29udHJvbFwiIHBsYWNlaG9sZGVyPVwiWW91ciAke29wdGlvbnMuZmllbGR9XCIgYXJpYS1sYWJlbD1cIllvdXIgJHtvcHRpb25zLmZpZWxkfVwiIGFyaWEtZGVzY3JpYmVkYnk9XCIke29wdGlvbnMuZmllbGR9LXN1Ym1pdFwiPiBcXCBcclxuICBcdFx0XHQ8ZGl2IGNsYXNzPVwiaW5wdXQtZ3JvdXAtYXBwZW5kXCI+IFxcXHJcblx0XHRcdDxzcGFuIGNsYXNzPVwiaW5wdXQtZ3JvdXAtdGV4dFwiIGlkPVwiJHtvcHRpb25zLmZpZWxkfS1zdWJtaXRcIj4gb2s8L3NwYW4+PC9kaXY+PC9kaXY+YFxyXG4gICAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgICAgbGV0IGdvID0gJChgIyR7b3B0aW9ucy5maWVsZH0tc3VibWl0YCk7XHJcbiAgICAgICAgICAgIHBhdXNlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgIGdvLm9uKFwiY2xpY2tcIiwgdW5wYXVzZSk7XHJcbiAgICAgICAgICAgIHJldHVyblZhbHVlID0gcGF1c2VVbnRpbChgIyR7b3B0aW9ucy5maWVsZH0taW5wdXRgKTtcclxuXHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgXCJidXR0b25cIjpcclxuICAgICAgICAgICAgbGV0IHdyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYVwiKTtcclxuICAgICAgICAgICAgd3JhcHBlci5zdHlsZS5jb2xvciA9ICdibGFjayc7XHJcbiAgICAgICAgICAgIGxldCBwYXJlbnQgPSBjaGF0WzBdLnBhcmVudE5vZGU7XHJcbiAgICAgICAgICAgIHBhcmVudC5yZXBsYWNlQ2hpbGQod3JhcHBlciwgY2hhdFswXSk7XHJcbiAgICAgICAgICAgIHdyYXBwZXIuYXBwZW5kQ2hpbGQoY2hhdFswXSk7XHJcbiAgICAgICAgICAgIHdyYXBwZXIuY2xhc3NMaXN0LmFkZChcImNoYXQtYnV0dG9uXCIpO1xyXG4gICAgICAgICAgICBjaGF0LmFwcGVuZCgnPHAgY2xhc3M9XCJjaGF0LXRleHRcIj4nICsgb3B0aW9ucy50ZXh0ICsgXCI8L3A+XCIpO1xyXG5cclxuICAgICAgICAgICAgcGF1c2UgPSB0cnVlO1xyXG4gICAgICAgICAgICBjaGF0Lm9uKFwiY2xpY2tcIiwgdW5wYXVzZSk7XHJcbiAgICAgICAgICAgIHJldHVyblZhbHVlID0gcGF1c2VVbnRpbCgpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgIH1cclxuICAgIGlmIChvcHRpb25zLndyaXRlciA9PT0gXCJib3RcIikge1xyXG4gICAgICAgIGlmICgkKFwiLmNvbnRlbnQtY29sdW1uXCIpLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgICAgbGV0IGxvZ29TaGlmdERvd24gPVxyXG4gICAgICAgICAgICAgICAgJChcIi5yb3ctY3VycmVudFwiKS5oZWlnaHQoKSAvIDIgK1xyXG4gICAgICAgICAgICAgICAgJChcIiNsYXN0LWJvdC1yb3dcIikuaGVpZ2h0KCkgLyAyO1xyXG4gICAgICAgICAgICBsZXQgcm93c1RvU2hpZnQgPSAkKFwiLmhlaWdodC1zaGlmdFwiKTtcclxuICAgICAgICAgICAgaWYgKHJvd3NUb1NoaWZ0Lmxlbmd0aCAhPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgcm93c1RvU2hpZnQuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9nb1NoaWZ0RG93biArPSAkKHRoaXMpLmhlaWdodCgpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgJChcIiNib3QtbG9nby1jdXJyZW50XCIpLnZlbG9jaXR5KFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRvcDogbG9nb1NoaWZ0RG93bixcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IDQwMCxcclxuICAgICAgICAgICAgICAgICAgICBlYXNpbmc6IFwiZWFzZUluUXVhZFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlOiBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoZWxlbWVudClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY3NzKFwidmlzaWJpbGl0eVwiLCBcImhpZGRlblwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZW1vdmVBdHRyKFwiaWRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dzVG9TaGlmdC5yZW1vdmVDbGFzcyhcImhlaWdodC1zaGlmdFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgMzAwKTtcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAkKFwiI2xhc3QtYm90LXJvd1wiKS5yZW1vdmVBdHRyKFwiaWRcIik7XHJcblxyXG4gICAgICAgICAgICAkKFwiI2JvdC1sb2dvLWN1cnJlbnRcIikucmVtb3ZlQXR0cihcImlkXCIpO1xyXG4gICAgICAgICAgICAkKFwiYm90LWxvZ29cIikubGFzdCgpLmF0dHIoXCJpZFwiLCBcImJvdC1sb2dvLWN1cnJlbnRcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgICQoXCIjbGVmdC10YWctY3VycmVudFwiKS5hcHBlbmQobG9nb1RleHQpO1xyXG4gICAgICAgICQoXCIucm93LWN1cnJlbnRcIikuYXR0cihcImlkXCIsIFwibGFzdC1ib3Qtcm93XCIpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBhd2FpdCByZXR1cm5WYWx1ZTtcclxufVxyXG5cclxuZnVuY3Rpb24gZGVsYXkobXMpIHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJlc29sdmUobnVsbCk7XHJcbiAgICAgICAgfSwgbXMpO1xyXG4gICAgfSk7XHJcbn1cclxuZnVuY3Rpb24gdW5wYXVzZSgpIHtcclxuICAgIHBhdXNlID0gZmFsc2U7XHJcbn1cclxuYXN5bmMgZnVuY3Rpb24gcGF1c2VVbnRpbChlbGVtZW50KSB7XHJcbiAgICB3aGlsZSAocGF1c2UpIHtcclxuICAgICAgICBhd2FpdCBkZWxheSgxMDApO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuICQoZWxlbWVudCkudmFsKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGVuY3J5cHRGb3JtRGF0YShkYXRhKSB7XHJcbiAgICBsZXQgcHVibGljS2V5O1xyXG59XHJcbiJdfQ==
